{% extends 'base.html' %} {% block content %}

<div>
    <div clas>
        <form method="POST">
            {% csrf_token %}
              <input type="hidden" name="create_post" id="create_post">
              <button id="create-button" type="submit" class="bg-green-500 text-white font-semibold py-1 px-4 rounded-full hover:bg-green-600 transition">Create Post</button>
          </form>
    </div>

    <div class="py-4">
        <label for="filter" class="text-white font-semibold">Filter Posts:</label>
        <form method="GET" class="inline" id="filterForm">
            {% csrf_token %}
            <select id="filter" name="filter" class="bg-gray-700 text-white rounded-lg p-2" onchange="document.getElementById('filterForm').submit();">
                <option value="all" {% if filter_val == "all" %}selected{% endif %}>All</option>
                <option value="liked" {% if filter_val == "liked" %}selected{% endif %}>Liked by You</option>
                <option value="recent" {% if filter_val == "recent" %}selected{% endif %}>Recently Created</option>
            </select>
        </form>
    </div>

    <div class="py-10" id="">
        <div id="post-list">
            {% for post in posts %}
            <div class="bg-gray-800 text-white rounded-full px-4 py-2 m-2">
                {{ post.user }}
                {{ post.created_at }}
                {{ post.wrap }}
                {% for user in post.liked_by.all %}
                    {{ user.id }}
                {% endfor %}
                <form method="POST" action="#" class="mb-2">
                    {% csrf_token %}
                    <button type="submit" id="heartButton" name="favorite" class="flex items-center p-2 mt-4 bg-black rounded-lg shadow hover:bg-gray-200 transition duration-300">
                    <input type="hidden" name="post_id" value="{{ post.id }}">
                      {% if user in post.liked_by.all %}
                      <i class="fa-solid fa-heart"></i>
                      {% else %}
                      <i class="fa-regular fa-heart"></i>
                      {% endif %}
                    </button>
                </form>
                <div class="text-white">
                    <div>
                        Number of likes: {{ post.liked_by.all|length }}
                    </div>
                    <form method="POST" id="share">
                        {% csrf_token %}
                        <button type="submit" name="share">
                            <input type="hidden" name="post_id" value="{{ post.id }}">
                            Share
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

{% endblock %}